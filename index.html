<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add to Calendar</title>
  </head>
  <body>
    <button id="download-ics">Download Calendar Event (.ics)</button>

    <script>
      document
        .getElementById("download-ics")
        .addEventListener("click", function () {
          // Array of multiple events
          const events = [
            {
              title: "Event 1",
              details: "Details about event 1.",
              location: "Location 1",
              start: "2024-10-25T09:00:00",
              end: "2024-10-25T10:00:00",
            },
            {
              title: "Event 2",
              details: "Details about event 2.",
              location: "Location 2",
              start: "2024-10-26T11:00:00",
              end: "2024-10-26T12:00:00",
            },
            // Add more events if needed
          ];

          // Create .ics content
          let icsContent =
            "BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Your Company//NONSGML v1.0//EN\n";

          events.forEach((event) => {
            const startDate =
              new Date(event.start)
                .toISOString()
                .replace(/[-:.]/g, "")
                .slice(0, 15) + "Z";
            const endDate =
              new Date(event.end)
                .toISOString()
                .replace(/[-:.]/g, "")
                .slice(0, 15) + "Z";

            icsContent += `
BEGIN:VEVENT
SUMMARY:${event.title}
DESCRIPTION:${event.details}
LOCATION:${event.location}
DTSTART:${startDate}
DTEND:${endDate}
END:VEVENT
`;
          });

          icsContent += "END:VCALENDAR";

          // Create a blob with the .ics content
          const blob = new Blob([icsContent], { type: "text/calendar" });

          // Create a download link for the .ics file
          const link = document.createElement("a");
          link.href = URL.createObjectURL(blob);
          link.download = "events.ics";

          // Simulate a click on the link to trigger the download
          link.click();
        });
    </script>
  </body>
</html>
